<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Deck Completion Stats</title>
<link rel="stylesheet" href="app.css" />
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.0"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.1.0"></script>
</head>
<body>
  <h1 class="page-heading-top">Deck Completion Stats</h1>
  <div class="layout-header center-header">
    <div class="header-stats-group">
      <div id="completionBox" class="streak-flame kpi-completion">
        <div class="flame-core"></div>
        <div class="streak-num" id="completionPercent">0%</div>
        <div class="streak-label">COMPLETION</div>
      </div>
      <div id="studiedTimeBox" class="streak-flame kpi-studied">
        <div class="flame-core"></div>
        <div class="streak-num" id="studiedTimeHHMM">0</div>
        <div class="streak-label">HOURS STUDIED</div>
      </div>
      <div id="streakContainer" class="streak-flame kpi-streak">
        <div class="flame-core"></div>
        <div class="streak-num" id="streakDays">0</div>
        <div class="streak-label">DAY STREAK</div>
      </div>
    </div>
  </div>

  <div class="settings-wrapper">
    <div class="card settings-card fancy">
      <div class="settings-lines">
        <div class="setting-line" id="deckLine">Current deck: <span id="currentDeck" class="interactive">(All Decks)</span> <span id="deckCount" class="muted"></span></div>
        <div class="setting-line" id="modelLine">Current model: <span id="currentModel" class="interactive">(Any Model)</span></div>
      </div>
    </div>
  </div>

  <div class="cards-container single-column">
    <div class="card">
      <h2 class="card-title">Progress</h2>
      <div class="card-desc">Overall studied cards over time. Shows how your total grows each period and projected finish.</div>
      <canvas id="statsChart" class="chart-canvas"></canvas>
      <label class="forecast-toggle below"><input type="checkbox" id="forecastToggle"> Show forecast</label>
      <div id="forecastSummaries" class="summaries" style="display:none;"></div>
    </div>

    <div class="card" id="statusSection" style="display:none;">
      <h2 class="card-title">Status</h2>
      <div class="card-desc">Snapshot of current card states.</div>
      <div id="statusCharts" class="status-charts"></div>
    </div>

    <div class="card" id="milestonesSection" style="display:none;">
      <h2 class="card-title">Milestones</h2>
      <div class="card-desc">Key count goals already reached and projected future ones.</div>
      <div id="milestonesContent" class="milestones-grid"></div>
    </div>

    <div class="card" id="learningHistorySection">
      <h2 class="card-title">Learning History</h2>
      <div class="card-desc">New cards first studied in each period.</div>
      <canvas id="learningHistoryChart" class="chart-canvas"></canvas>
      <div id="learningHistorySummary" class="summaries" style="display:none;"></div>
    </div>

    <div class="card" id="timeStudiedSection" style="display:none;">
      <h2 class="card-title">Time Studied</h2>
      <div class="card-desc">Total study time spent each period.</div>
      <canvas id="timeStudiedChart" class="chart-canvas"></canvas>
      <div id="timeStudiedSummary" class="summaries"></div>
    </div>

    <div class="card" id="timeSpentSection">
      <h2 class="card-title">Time Spent on Each Card</h2>
      <div class="card-desc">Distribution of total study time per card for each card type.</div>
      <div id="timeSpentCharts" class="time-histograms"></div>
      <div id="timeSpentTables" class="table-wrap"></div>
    </div>

    <div class="card" id="difficultSection">
      <h2 class="card-title">Most Difficult Cards</h2>
      <div class="card-desc">Cards with the highest wrong answer counts.</div>
      <div id="difficultCharts" class="time-histograms"></div>
      <div id="difficultTables" class="table-wrap"></div>
    </div>
  </div>

    <div class="foot">
    Made by Jacob Zhang | 
    <a href="https://github.com/jacbz/anki_deckcompletionstats" target="_blank" rel="noopener" class="github-link">
      <svg class="github-icon" viewBox="0 0 16 16" width="12" height="12" fill="currentColor">
        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
      </svg>
      GitHub
    </a>
  </div>

  <!-- Floating pill with granularity + template selection   -->
  <div id="floatingControls" class="floating-pill vertical">
    <div class="pill-header">
      <div class="pill-toggle" title="Collapse / Expand"></div>
    </div>
    <div class="pill-content">
      <div class="pill-group">
        <div class="pill-label">Granularity</div>
        <div id="granularityRadios" class="pill-granularity">
          <label class="granularity-radio"><input type="radio" name="granularity" value="days">Days</label>
          <label class="granularity-radio"><input type="radio" name="granularity" value="weeks">Weeks</label>
          <label class="granularity-radio"><input type="radio" name="granularity" value="months">Months</label>
          <label class="granularity-radio"><input type="radio" name="granularity" value="quarters">Quarters</label>
          <label class="granularity-radio"><input type="radio" name="granularity" value="years">Years</label>
        </div>
      </div>
      <div class="pill-group templates-group">
        <div class="pill-label">Card Types</div>
        <div id="modelTemplates" class="templates-wrap"></div>
      </div>
    </div>
  </div>
<script src="app.js"></script>
</body>
</html>
